<!DOCTYPE html>
<html>
<head>
    <title>MP4 Files Index</title>
    <style>
        body { font-family: sans-serif; margin: 40px; }
        .video-list { list-style: none; padding: 0; }
        .video-list li { margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; border-radius: 5px; }
        .video-list li a { font-weight: bold; text-decoration: none; color: #007bff; display: block; margin-bottom: 5px; }
        .video-list li a:hover { text-decoration: underline; }
    </style>
</head>
<body>

    <h1>MP4 Repository Contents</h1>
    <ul id="video-list" class="video-list">
        </ul>
    <p id="loading">Loading files...</p>
    <p id="error-message" style="color: red; display: none;">Error loading files. Check your repository name and user/org, or try again later.</p>

    <script>
        // *** REPLACE THESE VALUES ***
        const GITHUB_USER = 'brandonshanehawkins'; // e.g., 'octocat'
        const GITHUB_REPO = 'sora-downloads'; // e.g., 'video-repo'
        const GITHUB_BRANCH = 'main'; // or 'master', or your Pages branch

        const API_URL = `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/`;
        const FILES_CONTAINER = document.getElementById('video-list');
        const LOADING_MESSAGE = document.getElementById('loading');
        const ERROR_MESSAGE = document.getElementById('error-message');

        async function listMp4Files() {
            try {
                // Fetch the contents of the root directory
                const response = await fetch(API_URL);
                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'Failed to fetch repository contents.');
                }
                
                // Filter and display MP4 files
                const mp4Files = data.filter(file => file.type === 'file' && file.name.endsWith('.mp4'));

                if (mp4Files.length === 0) {
                    FILES_CONTAINER.innerHTML = '<li>No MP4 files found in the root directory.</li>';
                } else {
                    mp4Files.forEach(file => {
                        const fileURL = `https://${GITHUB_USER}.github.io/${GITHUB_REPO}/${file.path}`;
                        
                        const listItem = document.createElement('li');
                        
                        // Link to the video file
                        const link = document.createElement('a');
                        link.href = fileURL;
                        link.textContent = file.name;
                        listItem.appendChild(link);
                        
                        // Optional: Embed a simple video player for direct playback
                        const video = document.createElement('video');
                        video.src = fileURL;
                        video.controls = true;
                        video.style.maxWidth = '100%';
                        video.style.marginTop = '10px';
                        video.style.height = 'auto';
                        listItem.appendChild(video);
                        
                        FILES_CONTAINER.appendChild(listItem);
                    });
                }
            } catch (error) {
                console.error('Error listing files:', error);
                ERROR_MESSAGE.style.display = 'block';
                FILES_CONTAINER.innerHTML = ''; // Clear the list
            } finally {
                LOADING_MESSAGE.style.display = 'none'; // Hide loading message
            }
        }

        listMp4Files();
    </script>

</body>
</html>
